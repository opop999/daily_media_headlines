---
title: "Yesterday's Czech News Headlines"
date: "Last updated `r format(Sys.time(),'%d. %m. %Y')`"
author: "Ondrej Pekacek"
output: 
  flexdashboard::flex_dashboard:
    theme: journal
    orientation: columns
    vertical_layout: fill
    source_code: https://github.com/opop999/daily_media_headlines
    navbar:
      - {title: "Data: News API", icon: "ion-cloud", href: "https://newsapi.org/"}
---

```{r setup, include=FALSE}
# Disable scientific notation of numbers
options(scipen = 999)

# Package names
packages <- c("dplyr", "stringr", "tidytext", "readr", "udpipe", "wordcloud")

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE))

source("02_transform_text.R")

# Directory where summary data were saved
dir_name <- "data"

# Specify output directory for individual word clouds
dir_name_out <- "data/past_word_clouds"

# Run function that transforms text
word_cloud_list <- transform_news_text(dir_name = dir_name, dir_name_out = dir_name_out)

#Define a color palette for the Word Cloud
palette <- brewer.pal(9, "YlOrBr")

```

Column {.tabset}
-----------------------------------------------------------------------

### **NEWS HEADLINES**

```{r}

set.seed(2021)
word_cloud_list$tokenized_headlines_clean_counted %>% with(wordcloud(tokens, 
                                n, 
                                random.order = FALSE,
                                scale = c(3,.6), 
                                min.freq = 1, 
                                max.words = 50, 
                                colors = palette))

```

### **NEWS HEADLINES NEGATIVE**

```{r}
word_cloud_list$lemma_headlines_clean_neg %>% with(wordcloud(lemma, 
                                n, 
                                random.order = FALSE,
                                scale = c(3,.6), 
                                min.freq = 1, 
                                max.words = 100, 
                                colors = palette))

```

### **NEWS HEADLINES POSITIVE**

```{r}
word_cloud_list$lemma_headlines_clean_pos %>% with(wordcloud(lemma, 
                                n, 
                                random.order = FALSE,
                                scale = c(3,.6), 
                                min.freq = 1, 
                                max.words = 100, 
                                colors = palette))

```

Column {.tabset}
-----------------------------------------------------------------------

### **ELECTION HEADLINES**
```{r}
set.seed(2021)

word_cloud_list$tokenized_query_clean_counted %>% with(wordcloud(tokens, 
                                n, 
                                random.order = FALSE,
                                scale = c(3,.6), 
                                min.freq = 1, 
                                max.words = 50, 
                                colors = palette))
```

### **ELECTION HEADLINES NEGATIVE**

```{r}
word_cloud_list$lemma_query_clean_neg %>% with(wordcloud(lemma, 
                                n, 
                                random.order = FALSE,
                                scale = c(3,.6), 
                                min.freq = 1, 
                                max.words = 100, 
                                colors = palette))

```

### **ELECTION HEADLINES POSITIVE**

```{r}
word_cloud_list$lemma_query_clean_pos %>% with(wordcloud(lemma, 
                                n, 
                                random.order = FALSE,
                                scale = c(3,.6), 
                                min.freq = 1, 
                                max.words = 100, 
                                colors = palette))

```

```{r include=FALSE}
png(file = paste0(dir_name_out, "/", Sys.Date(), "_headlines.png"), width = 600, height = 600)

set.seed(2021)
word_cloud_list$tokenized_headlines_clean_counted %>% with(wordcloud(tokens, 
                                n, 
                                random.order = FALSE,
                                scale = c(3.5,.6), 
                                min.freq = 1, 
                                max.words = 50, 
                                colors = palette))
dev.off()

png(file = paste0(dir_name_out, "/", Sys.Date(), "_query.png"), width = 600, height = 600)

set.seed(2021)
word_cloud_list$tokenized_query_clean_counted %>% with(wordcloud(tokens, 
                                n, 
                                random.order = FALSE,
                                scale = c(3.5,.6), 
                                min.freq = 1, 
                                max.words = 50, 
                                colors = palette))
dev.off()
```
